<html>
<head>
<title>LA Filler. | Montro</title>
<link rel="stylesheet" href="resources/style.css" type="text/css">
<style type="text/css">
    #partOfSpeech, #pos { width:144px; }
    #synonyms, #forms { width:170px; }
    #defintion { width:484px; }
</style>
<script type="text/javascript">
function define(word) {
  var jsonString = UrlFetchApp.fetch("http://api.wordnik.com//v4/word.json/" + word + "/definitions?includeRelated=false&includeTags=false&limit=1&sourceDictionaries=webster&useCanonical=false&api_key=cf06c684dccd799f4d0030167b007115ef57402525d6baafc");
  jsonString = jsonString.getContentText().substr(1).slice(0, -1);
  var object = Utilities.jsonParse(jsonString);
  for (var i in object) {
    if (i == "text") {
      return(object[i]);
    }
  }
}
function partofSpeech(word) {
  var jsonString = UrlFetchApp.fetch("http://api.wordnik.com//v4/word.json/" + word + "/definitions?includeRelated=false&includeTags=false&limit=1&sourceDictionaries=webster&useCanonical=false&api_key=cf06c684dccd799f4d0030167b007115ef57402525d6baafc");
  jsonString = jsonString.getContentText().substr(1).slice(0, -1);
  var object = Utilities.jsonParse(jsonString);
  for (var i in object) {
    if (i == "partOfSpeech") {
      return(object[i]);
    }
  }
}
function synonyms(word) {
  var jsonString = UrlFetchApp.fetch("http://api.wordnik.com//v4/word.json/" + word + "/relatedWords?limitPerRelationshipType=3&relationshipTypes=synonym&useCanonical=false&api_key=cf06c684dccd799f4d0030167b007115ef57402525d6baafc");
  jsonString = jsonString.getContentText().substr(1).slice(0, -1);
  var object = Utilities.jsonParse(jsonString);
  for (var i in object) {
    if (i == "words") {
      return(object[i].toString().replace(/,/g, ", "));
    }
  }
}
function forms(word) {
  var jsonString = UrlFetchApp.fetch("http://api.wordnik.com//v4/word.json/" + word + "/relatedWords?limitPerRelationshipType=3&relationshipTypes=form&useCanonical=false&api_key=cf06c684dccd799f4d0030167b007115ef57402525d6baafc");
  jsonString = jsonString.getContentText().substr(1).slice(0, -1);
  var object = Utilities.jsonParse(jsonString);
  for (var i in object) {
    if (i == "words") {
      return(object[i].toString().replace(/,/g, ", "));
    }
  }
}
function display() {
  var lineNumber = 3
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  for (lineNumber; lineNumber<22; lineNumber+=6) {
    SpreadsheetApp.setActiveRange(ss.getSheets()[0].getRange("B" + lineNumber));
    var word = SpreadsheetApp.getActiveRange().getValue().toLowerCase();
    
    //update part of speech
    SpreadsheetApp.setActiveRange(ss.getSheets()[0].getRange("C" + lineNumber));
    SpreadsheetApp.getActiveRange().setValue("(" + partofSpeech(word) + "):");
    //update defintion
    SpreadsheetApp.setActiveRange(ss.getSheets()[0].getRange("D" + lineNumber));
    SpreadsheetApp.getActiveRange().setValue(define(word));
    //update synonym
    SpreadsheetApp.setActiveRange(ss.getSheets()[0].getRange("B" + (lineNumber + 1)));
    SpreadsheetApp.getActiveRange().setValue("Syn: " + synonyms(word));
    //update forms
    SpreadsheetApp.setActiveRange(ss.getSheets()[0].getRange("D" + (lineNumber + 1)));
    SpreadsheetApp.getActiveRange().setValue("Other forms: " + forms(word));
  }
}

</script>
</head>
<body>
<div id="head">
<span id="shead">Montro</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="links">&nbsp;&nbsp;
<span><a href="index.html">Home.</a></span>&nbsp;&nbsp;-&nbsp;&nbsp;<span>
<a href="scripts.html">Scripts.</a></span>&nbsp;&nbsp;-&nbsp;&nbsp;
<span>About.</span></span>
</div>
<br>
<div id="maincontent">
<center><p style="font-size:30px;line-height:0px;">LA Filler.</p></center>
<br><center><p style="margin:5px;font-size:16px;">Enter dictionary word here:</p></center>
<table id="input"><tr>
<td><center>Word.</center></td></tr>
<tr><td><center><input id="word" /></center></td>
</tr><tr><td colspan="2">
<center><input type="button" class="calculate" value="Calculate." onClick="calculate()" /></center>
</td></tr></table>


<br><center><p style="margin:5px;font-size:16px;">Results:</p></center>
<table id="answers"><tr>
<td><center>Part of Speech:</center></td><td><center>Synonym(s):</center></td><td><center>Other Form(s):</center></td></tr>
<tr><td id="pos"><center><input id="partOfSpeech" type="text" /></center></td>
<td><center><input id="synonyms" type="text" /></center></td>
<td><center><input id="forms" type="text" /></center></td></tr>
<tr><td colspan="3"><center>Definition:</center></td></tr>
<tr><td colspan="3"><center><input id="defintion" type="text"></center></td></tr>
</table>
</p>
<center>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<footer>A Moin Nadeem Production.</footer></center></div>

</p></div>
</body>
</html>